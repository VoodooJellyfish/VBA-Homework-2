Sub stocks()    For Each ws In Worksheets            Dim row_count As Long        Dim stock_volume As Double        Dim Ticker As String        Dim yearly_Change As Double        Dim percent_change As Double        Dim last_row As Long        Dim open_price As Double        Dim close_price As Double                ws.Range("I1").Value = "Ticker"        ws.Range("J1").Value = "Yearly Change"        ws.Range("K1").Value = "Percent Change"        ws.Range("L1").Value = "Total Stock Volume"            last_row = ws.Cells(Rows.Count, "A").End(xlUp).Row + 1        row_count = 2        open_price = ws.Cells(2, 3).Value            For i = 2 To last_row            If ws.Cells(i, 1).Value = ws.Cells(i + 1, 1).Value Then                stock_volume = stock_volume + ws.Cells(i, 7).Value            Else                close_price = ws.Cells(i, 6).Value                yearly_Change = close_price - open_price                    If open_price = 0 Then                        percent_change = 0                 Else: percent_change = (yearly_Change / open_price) * 100                    End If            open_price = ws.Cells(i + 1, 3).Value            stock_volume = stock_volume + ws.Cells(i, 7).Value            Ticker = ws.Cells(i, 1).Value            ws.Cells(row_count, 9) = Ticker            ws.Cells(row_count, 10) = yearly_Change            ws.Cells(row_count, 11) = percent_change            ws.Cells(row_count, 12) = stock_volume            stock_volume = 0            row_count = row_count + 1        End If        Next i            For i = 2 To row_count        ws.Cells(i, 11).Interior.ColorIndex = 0        If ws.Cells(i, 10).Value >= 0 Then                ws.Cells(i, 10).Interior.ColorIndex = 4        Else            ws.Cells(i, 10).Interior.ColorIndex = 3            End If        Next i        Next ws    End Sub